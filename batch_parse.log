Batch processing all folders to generate spark_tracks.csv with region data...
TIFF base: /Users/jdietz/Documents/Levin/Embryos
Output: spark_tracks_with_regions.csv

Processing folder 1...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/1
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 602

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2220x600 pixels

  File 1/2: B - Substack (1-301).tif (page 51) → 5 embryo(s) detected
  File 2/2: C - Substack (1-301).tif (page 1) → 3 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=411.7, embryo_threshold=494.0
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Using single embryo head-tail length: 269.9px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1585.0, 260.0), tail=(1853.8, 236.1), axis_length=269.9px, centroid=(1723.2, 247.8)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 6 early spark(s): (1732.0, 219.0)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/602 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/602...
Processing frame 201/602...
Processing frame 301/602...
Processing frame 401/602...
Processing frame 501/602...
Processing frame 601/602...
Processing frame 602/602...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 602
  • Spark detections:
    - Total raw detections: 2493
    - Total track states (CSV rows): 2493
    - Frames with detections: 602/602
    - Average detections per frame: 4.14
    - Max detections in single frame: 16
  • Unique tracks: 224
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (1732.0, 219.0)

Output files:
  • CSV: temp_1.csv
============================================================

  ✓ Completed folder 1
Processing folder 2...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/2
============================================================

Found 4 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 691

Searching for reference frame with embryos...
Checking first frame of 4 file(s) for embryos...

Frame dimensions: 2960x880 pixels

  File 1/4: B - Substack (1-300).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/4

Initializing geometry from reference frame...
  16-bit embryo detection: background=319.0, embryo_threshold=382.7

  → Standard head-tail length: 1333.4px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1412.0, 501.0), tail=(82.8, 606.4), axis_length=1333.4px, centroid=(814.1, 467.3)
  Embryo B: head=(1439.0, 522.0), tail=(2770.2, 445.0), axis_length=1333.4px, centroid=(2092.0, 428.5)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 37 early spark(s): (1280.5, 397.0)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/691 [POKE FRAME - t=0]...
  → Detected 6 spark detection(s), 6 track state(s) in poke frame
Processing frame 101/691...
Processing frame 201/691...
Processing frame 301/691...
Processing frame 401/691...
Processing frame 501/691...
Processing frame 601/691...
Processing frame 691/691...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 4
  • Total frames processed: 691
  • Spark detections:
    - Total raw detections: 3867
    - Total track states (CSV rows): 3867
    - Frames with detections: 691/691
    - Average detections per frame: 5.60
    - Max detections in single frame: 36
  • Unique tracks: 365
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/4
  • Poke location: ✓ detected at (1280.5, 397.0)

Output files:
  • CSV: temp_2.csv
============================================================

  ✓ Completed folder 2
Processing folder 3...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/3
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 602

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2954x924 pixels

  File 1/2: B - Substack (1-301).tif (page 51) → 3 embryo(s) detected
  File 2/2: C - Substack (1-301).tif (page 101) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=313.6, embryo_threshold=376.4
  ⚠ Warning: Cannot determine head/tail from morphology for embryo B. Using default assignment. Consider manual specification.

  → Standard head-tail length: 1429.7px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(118.0, 586.0), tail=(1546.7, 530.9), axis_length=1429.7px, centroid=(752.0, 492.1)
  Embryo B: head=(1426.0, 348.0), tail=(2854.9, 299.3), axis_length=1429.7px, centroid=(2162.4, 448.8)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 85 early spark(s): (2681.3, 341.6)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/602 [POKE FRAME - t=0]...
  → Detected 14 spark detection(s), 14 track state(s) in poke frame
Processing frame 101/602...
Processing frame 201/602...
Processing frame 301/602...
Processing frame 401/602...
Processing frame 501/602...
Processing frame 601/602...
Processing frame 602/602...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 602
  • Spark detections:
    - Total raw detections: 10705
    - Total track states (CSV rows): 10705
    - Frames with detections: 602/602
    - Average detections per frame: 17.78
    - Max detections in single frame: 76
  • Unique tracks: 3427
  • Embryos detected: 2 (A, B)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (2681.3, 341.6)

Output files:
  • CSV: temp_3.csv
============================================================

  ✓ Completed folder 3
Processing folder 4...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/4
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 628

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2954x960 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/2: C - Substack (49-375).tif (page 51) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=320.9, embryo_threshold=385.0
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Standard head-tail length: 1418.6px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(126.0, 532.0), tail=(1543.2, 467.8), axis_length=1418.6px, centroid=(838.5, 440.7)
  Embryo B: head=(2959.0, 293.0), tail=(1540.5, 309.3), axis_length=1418.6px, centroid=(2266.8, 328.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 281 early spark(s): (2142.2, 485.0)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/628 [POKE FRAME - t=0]...
  → Detected 44 spark detection(s), 44 track state(s) in poke frame
Processing frame 101/628...
Processing frame 201/628...
Processing frame 301/628...
Processing frame 401/628...
Processing frame 501/628...
Processing frame 601/628...
Processing frame 628/628...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 628
  • Spark detections:
    - Total raw detections: 12037
    - Total track states (CSV rows): 12037
    - Frames with detections: 628/628
    - Average detections per frame: 19.17
    - Max detections in single frame: 61
  • Unique tracks: 3963
  • Embryos detected: 2 (A, B)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (2142.2, 485.0)

Output files:
  • CSV: temp_4.csv
============================================================

  ✓ Completed folder 4
Processing folder 5...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/5
============================================================

Found 4 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 936

Searching for reference frame with embryos...
Checking first frame of 4 file(s) for embryos...

Frame dimensions: 2840x768 pixels

  File 1/4: B after poke - Substack (1-361).tif (page 1) → 1 embryo(s) detected
    Diagnostic: mask_area=15219, min_area=10196, threshold=410.5, contours_found=66
  File 2/4: B before poke - Substack (1-361) .tif → 0 embryos
  File 3/4: C - Substack (47-259).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 2/4

Initializing geometry from reference frame...
  16-bit embryo detection: background=350.7, embryo_threshold=420.8
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Standard head-tail length: 426.6px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(208.0, 597.0), tail=(610.3, 455.0), axis_length=426.6px, centroid=(418.5, 554.1)
  Embryo B: head=(832.0, 427.0), tail=(1258.5, 437.9), axis_length=426.6px, centroid=(1048.4, 440.3)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 462 early spark(s): (1094.2, 391.3)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/936 [POKE FRAME - t=0]...
  → Detected 47 spark detection(s), 47 track state(s) in poke frame
Processing frame 101/936...
Processing frame 201/936...
Processing frame 301/936...
Processing frame 401/936...
Processing frame 501/936...
Processing frame 601/936...
Processing frame 701/936...
Processing frame 801/936...
Processing frame 901/936...
Processing frame 936/936...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 4
  • Total frames processed: 936
  • Spark detections:
    - Total raw detections: 41415
    - Total track states (CSV rows): 41415
    - Frames with detections: 936/936
    - Average detections per frame: 44.25
    - Max detections in single frame: 147
  • Unique tracks: 12594
  • Embryos detected: 2 (A, B)
  • Files with embryos: 2/4
  • Poke location: ✓ detected at (1094.2, 391.3)

Output files:
  • CSV: temp_5.csv
============================================================

  ✓ Completed folder 5
Processing folder 6...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/6
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 713

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2912x912 pixels

  File 1/2: B - Substack (1-301).tif (page 101) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=392.3, embryo_threshold=470.7
  ⚠ Warning: Cannot determine head/tail from morphology for embryo B. Using default assignment. Consider manual specification.

  → Standard head-tail length: 1327.9px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(117.0, 490.0), tail=(1444.9, 479.4), axis_length=1327.9px, centroid=(751.3, 457.6)
  Embryo B: head=(1449.0, 386.0), tail=(2776.8, 371.6), axis_length=1327.9px, centroid=(2107.8, 396.9)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 11 early spark(s): (2032.1, 391.5)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/713 [POKE FRAME - t=0]...
  → Detected 2 spark detection(s), 2 track state(s) in poke frame
Processing frame 101/713...
Processing frame 201/713...
Processing frame 301/713...
Processing frame 401/713...
Processing frame 501/713...
Processing frame 601/713...
Processing frame 701/713...
Processing frame 713/713...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 713
  • Spark detections:
    - Total raw detections: 1830
    - Total track states (CSV rows): 1830
    - Frames with detections: 713/713
    - Average detections per frame: 2.57
    - Max detections in single frame: 14
  • Unique tracks: 149
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/2
  • Poke location: ✓ detected at (2032.1, 391.5)

Output files:
  • CSV: temp_6.csv
============================================================

  ✓ Completed folder 6
Processing folder 7...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/7
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 703

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2948x960 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/2: C - Substack (20-421).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=317.2, embryo_threshold=380.6

  → Using single embryo head-tail length: 2626.7px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(143.0, 624.0), tail=(2761.5, 417.1), axis_length=2626.7px, centroid=(1358.3, 443.5)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 18 early spark(s): (913.4, 390.4)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/703 [POKE FRAME - t=0]...
  → Detected 3 spark detection(s), 3 track state(s) in poke frame
Processing frame 101/703...
Processing frame 201/703...
Processing frame 301/703...
Processing frame 401/703...
Processing frame 501/703...
Processing frame 601/703...
Processing frame 701/703...
Processing frame 703/703...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 703
  • Spark detections:
    - Total raw detections: 6926
    - Total track states (CSV rows): 6926
    - Frames with detections: 703/703
    - Average detections per frame: 9.85
    - Max detections in single frame: 45
  • Unique tracks: 1149
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (913.4, 390.4)

Output files:
  • CSV: temp_7.csv
============================================================

  ✓ Completed folder 7
Processing folder 8...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/8
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 682

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2960x784 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 3 embryo(s) detected
  File 2/2: C - Substack (42-422).tif (page 101) → 4 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=319.9, embryo_threshold=383.9
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.
  ⚠ Warning: Cannot determine head/tail from morphology for embryo B. Using default assignment. Consider manual specification.

  → Standard head-tail length: 587.9px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(311.0, 528.0), tail=(898.2, 499.7), axis_length=587.9px, centroid=(833.7, 365.1)
  Embryo B: head=(1013.0, 554.0), tail=(1508.1, 237.0), axis_length=587.9px, centroid=(1128.8, 557.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 34 early spark(s): (1978.7, 388.3)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/682 [POKE FRAME - t=0]...
  → Detected 4 spark detection(s), 4 track state(s) in poke frame
Processing frame 101/682...
Processing frame 201/682...
Processing frame 301/682...
Processing frame 401/682...
Processing frame 501/682...
Processing frame 601/682...
Processing frame 682/682...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 682
  • Spark detections:
    - Total raw detections: 4545
    - Total track states (CSV rows): 4545
    - Frames with detections: 682/682
    - Average detections per frame: 6.66
    - Max detections in single frame: 26
  • Unique tracks: 693
  • Embryos detected: 2 (A, B)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (1978.7, 388.3)

Output files:
  • CSV: temp_8.csv
============================================================

  ✓ Completed folder 8
Processing folder 9...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/9
============================================================

Found 3 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 447

Searching for reference frame with embryos...
Checking first frame of 3 file(s) for embryos...

Frame dimensions: 1506x816 pixels

  File 1/3: B1 - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/3: C1 - MAX_colored.tif → 1 embryo(s) detected
  File 3/3: C1 - Substack (1-145).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 3/3

Initializing geometry from reference frame...
  16-bit embryo detection: background=333.9, embryo_threshold=400.7

  → Using single embryo head-tail length: 1286.0px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1459.0, 334.0), tail=(173.5, 299.3), axis_length=1286.0px, centroid=(900.2, 378.0)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 39 early spark(s): (892.7, 328.9)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/447 [POKE FRAME - t=0]...
  → Detected 6 spark detection(s), 6 track state(s) in poke frame
Processing frame 101/447...
Processing frame 201/447...
Processing frame 301/447...
Processing frame 401/447...
Processing frame 447/447...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 3
  • Total frames processed: 447
  • Spark detections:
    - Total raw detections: 3607
    - Total track states (CSV rows): 3607
    - Frames with detections: 447/447
    - Average detections per frame: 8.07
    - Max detections in single frame: 21
  • Unique tracks: 502
  • Embryos detected: 1 (A)
  • Files with embryos: 3/3
  • Poke location: ✓ detected at (892.7, 328.9)

Output files:
  • CSV: temp_9.csv
============================================================

  ✓ Completed folder 9
Processing folder 10...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/10
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 528

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 1212x525 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/2: C - Substack (1-227).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=393.7, embryo_threshold=472.4
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Using single embryo head-tail length: 1109.3px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(0.0, 285.0), tail=(1108.1, 234.0), axis_length=1109.3px, centroid=(562.2, 251.5)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 6 early spark(s): (971.8, 145.6)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/528 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/528...
Processing frame 201/528...
Processing frame 301/528...
Processing frame 401/528...
Processing frame 501/528...
Processing frame 528/528...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 528
  • Spark detections:
    - Total raw detections: 3522
    - Total track states (CSV rows): 3522
    - Frames with detections: 528/528
    - Average detections per frame: 6.67
    - Max detections in single frame: 37
  • Unique tracks: 421
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (971.8, 145.6)

Output files:
  • CSV: temp_10.csv
============================================================

  ✓ Completed folder 10
Processing folder 11...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/11
============================================================

Found 3 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 603

Searching for reference frame with embryos...
Checking first frame of 3 file(s) for embryos...

Frame dimensions: 1528x748 pixels

  File 1/3: B - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/3: C - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 3/3: TMR.tif → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 3/3

Initializing geometry from reference frame...
  16-bit embryo detection: background=374.0, embryo_threshold=448.8

  → Using single embryo head-tail length: 1143.0px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(97.0, 342.0), tail=(1239.4, 379.4), axis_length=1143.0px, centroid=(635.6, 371.8)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 105 early spark(s): (292.2, 353.8)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/603 [POKE FRAME - t=0]...
  → Detected 21 spark detection(s), 21 track state(s) in poke frame
Processing frame 101/603...
Processing frame 201/603...
Processing frame 301/603...
Processing frame 401/603...
Processing frame 501/603...
Processing frame 601/603...
Processing frame 603/603...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 3
  • Total frames processed: 603
  • Spark detections:
    - Total raw detections: 4009
    - Total track states (CSV rows): 4009
    - Frames with detections: 602/603
    - Average detections per frame: 6.65
    - Max detections in single frame: 25
  • Unique tracks: 789
  • Embryos detected: 1 (A)
  • Files with embryos: 3/3
  • Poke location: ✓ detected at (292.2, 353.8)

Output files:
  • CSV: temp_11.csv
============================================================

  ✓ Completed folder 11
Processing folder 12...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/12
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 678

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2904x952 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=387.0, embryo_threshold=464.4
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Standard head-tail length: 971.7px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(673.0, 364.0), tail=(1643.2, 309.2), axis_length=971.7px, centroid=(1088.6, 486.0)
  Embryo B: head=(1490.0, 517.0), tail=(2459.7, 454.7), axis_length=971.7px, centroid=(2014.3, 402.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 349 early spark(s): (1398.9, 438.4)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/678 [POKE FRAME - t=0]...
  → Detected 132 spark detection(s), 132 track state(s) in poke frame
Processing frame 101/678...
Processing frame 201/678...
Processing frame 301/678...
Processing frame 401/678...
Processing frame 501/678...
Processing frame 601/678...
Processing frame 678/678...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 678
  • Spark detections:
    - Total raw detections: 43267
    - Total track states (CSV rows): 43267
    - Frames with detections: 678/678
    - Average detections per frame: 63.82
    - Max detections in single frame: 176
  • Unique tracks: 15117
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/2
  • Poke location: ✓ detected at (1398.9, 438.4)

Output files:
  • CSV: temp_12.csv
============================================================

  ✓ Completed folder 12
Processing folder 13...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/13
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1101

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 1407x744 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/2: C - Substack (1-800).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=331.4, embryo_threshold=397.7
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Using single embryo head-tail length: 1289.7px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(0.0, 587.0), tail=(1285.8, 486.4), axis_length=1289.7px, centroid=(628.5, 352.3)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 6 early spark(s): (7.2, 421.6)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1101 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/1101...
Processing frame 201/1101...
Processing frame 301/1101...
Processing frame 401/1101...
Processing frame 501/1101...
Processing frame 601/1101...
Processing frame 701/1101...
Processing frame 801/1101...
Processing frame 901/1101...
Processing frame 1001/1101...
Processing frame 1101/1101...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 1101
  • Spark detections:
    - Total raw detections: 2720
    - Total track states (CSV rows): 2720
    - Frames with detections: 1096/1101
    - Average detections per frame: 2.47
    - Max detections in single frame: 16
  • Unique tracks: 434
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (7.2, 421.6)

Output files:
  • CSV: temp_13.csv
============================================================

  ✓ Completed folder 13
Processing folder 14...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/14
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 602

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 1452x684 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/2: C - Substack (1-301).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=335.8, embryo_threshold=402.9
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Using single embryo head-tail length: 1381.7px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(0.0, 500.0), tail=(1379.7, 425.1), axis_length=1381.7px, centroid=(684.4, 333.5)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 124 early spark(s): (178.0, 334.5)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/602 [POKE FRAME - t=0]...
  → Detected 18 spark detection(s), 18 track state(s) in poke frame
Processing frame 101/602...
Processing frame 201/602...
Processing frame 301/602...
Processing frame 401/602...
Processing frame 501/602...
Processing frame 601/602...
Processing frame 602/602...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 602
  • Spark detections:
    - Total raw detections: 8298
    - Total track states (CSV rows): 8298
    - Frames with detections: 602/602
    - Average detections per frame: 13.78
    - Max detections in single frame: 35
  • Unique tracks: 1323
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (178.0, 334.5)

Output files:
  • CSV: temp_14.csv
============================================================

  ✓ Completed folder 14
Processing folder 15...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/15
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 602

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2960x750 pixels

  File 1/2: B - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/2: C - Substack (1-301).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=330.6, embryo_threshold=396.7

  → Using single embryo head-tail length: 2592.2px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(237.0, 400.0), tail=(2826.1, 272.3), axis_length=2592.2px, centroid=(1502.1, 373.7)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 12 early spark(s): (1879.7, 383.7)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/602 [POKE FRAME - t=0]...
  → Detected 2 spark detection(s), 2 track state(s) in poke frame
Processing frame 101/602...
Processing frame 201/602...
Processing frame 301/602...
Processing frame 401/602...
Processing frame 501/602...
Processing frame 601/602...
Processing frame 602/602...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 602
  • Spark detections:
    - Total raw detections: 1958
    - Total track states (CSV rows): 1958
    - Frames with detections: 602/602
    - Average detections per frame: 3.25
    - Max detections in single frame: 16
  • Unique tracks: 156
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (1879.7, 383.7)

Output files:
  • CSV: temp_15.csv
============================================================

  ✓ Completed folder 15
Processing folder 16...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/16
============================================================

Found 5 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1151

Searching for reference frame with embryos...
Checking first frame of 5 file(s) for embryos...

Frame dimensions: 2874x738 pixels

  File 1/5: B 5 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/5: B 10 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 3/5: C after wound - MAX_colored.tif → 1 embryo(s) detected
  File 4/5: C after wound - Substack (55-601).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 4/5

Initializing geometry from reference frame...
  16-bit embryo detection: background=368.6, embryo_threshold=442.3

  → Standard head-tail length: 1320.0px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1380.0, 408.0), tail=(60.8, 453.7), axis_length=1320.0px, centroid=(787.7, 386.7)
  Embryo B: head=(1369.0, 309.0), tail=(2688.8, 285.3), axis_length=1320.0px, centroid=(1974.2, 326.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 38 early spark(s): (1140.9, 316.7)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1151 [POKE FRAME - t=0]...
  → Detected 7 spark detection(s), 7 track state(s) in poke frame
Processing frame 101/1151...
Processing frame 201/1151...
Processing frame 301/1151...
Processing frame 401/1151...
Processing frame 501/1151...
Processing frame 601/1151...
Processing frame 701/1151...
Processing frame 801/1151...
Processing frame 901/1151...
Processing frame 1001/1151...
Processing frame 1101/1151...
Processing frame 1151/1151...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 5
  • Total frames processed: 1151
  • Spark detections:
    - Total raw detections: 11733
    - Total track states (CSV rows): 11733
    - Frames with detections: 1151/1151
    - Average detections per frame: 10.19
    - Max detections in single frame: 53
  • Unique tracks: 1701
  • Embryos detected: 2 (A, B)
  • Files with embryos: 4/5
  • Poke location: ✓ detected at (1140.9, 316.7)

Output files:
  • CSV: temp_16.csv
============================================================

  ✓ Completed folder 16
Processing folder 17...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/17
============================================================

Found 4 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 435

Searching for reference frame with embryos...
Checking first frame of 4 file(s) for embryos...

Frame dimensions: 1509x495 pixels

  File 1/4: C after wound - MAX_Colored.tif → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/4

Initializing geometry from reference frame...
  8-bit embryo detection: background=29.0, embryo_threshold=41.5

  → Standard head-tail length: 846.0px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(0.0, 250.0), tail=(732.2, 673.6), axis_length=846.0px, centroid=(96.9, 415.6)
  Embryo B: head=(53.0, 189.0), tail=(898.3, 155.5), axis_length=846.0px, centroid=(677.3, 238.5)

=== POKE DETECTION SUMMARY ===
✓ Auto-detected poke location: (907.0, 140.0)
===================================


Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/435 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/435...
Processing frame 201/435...
Processing frame 301/435...
Processing frame 401/435...
Processing frame 435/435...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 4
  • Total frames processed: 435
  • Spark detections:
    - Total raw detections: 1353
    - Total track states (CSV rows): 1353
    - Frames with detections: 435/435
    - Average detections per frame: 3.11
    - Max detections in single frame: 13
  • Unique tracks: 272
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/4
  • Poke location: ✓ detected at (907.0, 140.0) (frame 0)

Output files:
  • CSV: temp_17.csv
============================================================

  ✓ Completed folder 17
Processing folder 18...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/18
============================================================

Found 4 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1381

Searching for reference frame with embryos...
Checking first frame of 4 file(s) for embryos...

Frame dimensions: 1524x570 pixels

  File 1/4: B - Substack (1-301).tif (page 51) → 3 embryo(s) detected
  File 2/4: C - Substack (24-901).tif (page 101) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 2/4

Initializing geometry from reference frame...
  16-bit embryo detection: background=395.4, embryo_threshold=474.5

  → Using single embryo head-tail length: 823.2px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(93.0, 273.0), tail=(900.4, 433.3), axis_length=823.2px, centroid=(409.3, 361.5)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 9 early spark(s): (431.2, 360.8)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1381 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/1381...
Processing frame 201/1381...
Processing frame 301/1381...
Processing frame 401/1381...
Processing frame 501/1381...
Processing frame 601/1381...
Processing frame 701/1381...
Processing frame 801/1381...
Processing frame 901/1381...
Processing frame 1001/1381...
Processing frame 1101/1381...
Processing frame 1201/1381...
Processing frame 1301/1381...
Processing frame 1381/1381...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 4
  • Total frames processed: 1381
  • Spark detections:
    - Total raw detections: 4318
    - Total track states (CSV rows): 4318
    - Frames with detections: 1284/1381
    - Average detections per frame: 3.13
    - Max detections in single frame: 16
  • Unique tracks: 1659
  • Embryos detected: 1 (A)
  • Files with embryos: 2/4
  • Poke location: ✓ detected at (431.2, 360.8)

Output files:
  • CSV: temp_18.csv
============================================================

  ✓ Completed folder 18
Processing folder 19...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/19
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 962

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2265x543 pixels

  File 1/2: B - Substack (1-421).tif (page 1) → 1 embryo(s) detected
  File 2/2: C - Substack (33-573).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=445.6, embryo_threshold=534.8
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Using single embryo head-tail length: 1969.6px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(154.0, 262.0), tail=(2123.3, 227.1), axis_length=1969.6px, centroid=(1153.9, 264.6)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 16 early spark(s): (340.1, 177.8)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/962 [POKE FRAME - t=0]...
  → Detected 3 spark detection(s), 3 track state(s) in poke frame
Processing frame 101/962...
Processing frame 201/962...
Processing frame 301/962...
Processing frame 401/962...
Processing frame 501/962...
Processing frame 601/962...
Processing frame 701/962...
Processing frame 801/962...
Processing frame 901/962...
Processing frame 962/962...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 962
  • Spark detections:
    - Total raw detections: 9233
    - Total track states (CSV rows): 9233
    - Frames with detections: 962/962
    - Average detections per frame: 9.60
    - Max detections in single frame: 38
  • Unique tracks: 2289
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (340.1, 177.8)

Output files:
  • CSV: temp_19.csv
============================================================

  ✓ Completed folder 19
Processing folder 20...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/20
============================================================

Found 3 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 824

Searching for reference frame with embryos...
Checking first frame of 3 file(s) for embryos...

Frame dimensions: 2658x1026 pixels

  File 1/3: B - Substack (1-421).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/3

Initializing geometry from reference frame...
  16-bit embryo detection: background=418.9, embryo_threshold=502.7

  → Standard head-tail length: 1131.6px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1279.0, 473.0), tail=(148.5, 423.0), axis_length=1131.6px, centroid=(778.7, 495.3)
  Embryo B: head=(1317.0, 484.0), tail=(2444.9, 574.7), axis_length=1131.6px, centroid=(1838.6, 553.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 6 early spark(s): (1318.0, 1.2)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/824 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/824...
Processing frame 201/824...
Processing frame 301/824...
Processing frame 401/824...
Processing frame 501/824...
Processing frame 601/824...
Processing frame 701/824...
Processing frame 801/824...
Processing frame 824/824...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 3
  • Total frames processed: 824
  • Spark detections:
    - Total raw detections: 2677
    - Total track states (CSV rows): 2677
    - Frames with detections: 823/824
    - Average detections per frame: 3.25
    - Max detections in single frame: 13
  • Unique tracks: 215
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/3
  • Poke location: ✓ detected at (1318.0, 1.2)

Output files:
  • CSV: temp_20.csv
============================================================

  ✓ Completed folder 20
Processing folder 21...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/21
============================================================

Found 1 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 299

Searching for reference frame with embryos...
Checking first frame of 1 file(s) for embryos...

Frame dimensions: 2960x768 pixels

  File 1/1: C - Substack (48-346).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/1

Initializing geometry from reference frame...
  16-bit embryo detection: background=399.9, embryo_threshold=479.9

  → Standard head-tail length: 1366.1px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1493.0, 335.0), tail=(126.9, 341.6), axis_length=1366.1px, centroid=(810.3, 386.9)
  Embryo B: head=(1538.0, 357.0), tail=(2894.3, 193.7), axis_length=1366.1px, centroid=(2144.1, 378.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 28 early spark(s): (2247.1, 470.8)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/299 [POKE FRAME - t=0]...
  → Detected 6 spark detection(s), 6 track state(s) in poke frame
Processing frame 101/299...
Processing frame 201/299...
Processing frame 299/299...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 1
  • Total frames processed: 299
  • Spark detections:
    - Total raw detections: 913
    - Total track states (CSV rows): 913
    - Frames with detections: 299/299
    - Average detections per frame: 3.05
    - Max detections in single frame: 12
  • Unique tracks: 121
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/1
  • Poke location: ✓ detected at (2247.1, 470.8)

Output files:
  • CSV: temp_21.csv
============================================================

  ✓ Completed folder 21
Processing folder 22...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/22
============================================================

Found 5 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1102

Searching for reference frame with embryos...
Checking first frame of 5 file(s) for embryos...

Frame dimensions: 2700x642 pixels

  File 1/5: B - Substack (1-301).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/5

Initializing geometry from reference frame...
  16-bit embryo detection: background=375.1, embryo_threshold=450.1
  ⚠ Warning: Cannot determine head/tail from morphology for embryo B. Using default assignment. Consider manual specification.

  → Standard head-tail length: 1238.5px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1328.0, 222.0), tail=(89.7, 242.7), axis_length=1238.5px, centroid=(734.8, 358.0)
  Embryo B: head=(1298.0, 349.0), tail=(2533.9, 268.7), axis_length=1238.5px, centroid=(1913.7, 314.6)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 7 early spark(s): (1108.2, 334.4)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1102 [POKE FRAME - t=0]...
  → Detected 2 spark detection(s), 2 track state(s) in poke frame
Processing frame 101/1102...
Processing frame 201/1102...
Processing frame 301/1102...
Processing frame 401/1102...
Processing frame 501/1102...
Processing frame 601/1102...
Processing frame 701/1102...
Processing frame 801/1102...
Processing frame 901/1102...
Processing frame 1001/1102...
Processing frame 1101/1102...
Processing frame 1102/1102...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 5
  • Total frames processed: 1102
  • Spark detections:
    - Total raw detections: 5775
    - Total track states (CSV rows): 5775
    - Frames with detections: 1102/1102
    - Average detections per frame: 5.24
    - Max detections in single frame: 89
  • Unique tracks: 1079
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/5
  • Poke location: ✓ detected at (1108.2, 334.4)

Output files:
  • CSV: temp_22.csv
============================================================

  ✓ Completed folder 22
Processing folder 23...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/23
============================================================

Found 5 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1892

Searching for reference frame with embryos...
Checking first frame of 5 file(s) for embryos...

Frame dimensions: 2886x972 pixels

  File 1/5: B 5 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/5: B 10 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 3/5: B 15 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 4/5: C after wound - Substack (32-901).tif (page 101) → 4 embryo(s) detected
  File 5/5: Contraction - Substack (325-445).tif (page 101) → 4 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 5/5

Initializing geometry from reference frame...
  16-bit embryo detection: background=377.6, embryo_threshold=453.1

  → Standard head-tail length: 704.6px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1488.0, 389.0), tail=(785.1, 340.7), axis_length=704.6px, centroid=(1034.8, 426.8)
  Embryo B: head=(1709.0, 562.0), tail=(2012.7, -73.8), axis_length=704.6px, centroid=(1647.5, 352.7)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 648 early spark(s): (1253.6, 453.8)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1892 [POKE FRAME - t=0]...
  → Detected 107 spark detection(s), 107 track state(s) in poke frame
Processing frame 101/1892...
Processing frame 201/1892...
Processing frame 301/1892...
Processing frame 401/1892...
Processing frame 501/1892...
Processing frame 601/1892...
Processing frame 701/1892...
Processing frame 801/1892...
Processing frame 901/1892...
Processing frame 1001/1892...
Processing frame 1101/1892...
Processing frame 1201/1892...
Processing frame 1301/1892...
Processing frame 1401/1892...
Processing frame 1501/1892...
Processing frame 1601/1892...
Processing frame 1701/1892...
Processing frame 1801/1892...
Processing frame 1892/1892...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 5
  • Total frames processed: 1892
  • Spark detections:
    - Total raw detections: 65451
    - Total track states (CSV rows): 65451
    - Frames with detections: 1892/1892
    - Average detections per frame: 34.59
    - Max detections in single frame: 124
  • Unique tracks: 19727
  • Embryos detected: 2 (A, B)
  • Files with embryos: 5/5
  • Poke location: ✓ detected at (1253.6, 453.8)

Output files:
  • CSV: temp_23.csv
============================================================

  ✓ Completed folder 23
Processing folder 24...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/24
============================================================

Found 5 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1872

Searching for reference frame with embryos...
Checking first frame of 5 file(s) for embryos...

Frame dimensions: 2865x615 pixels

  File 1/5: B 5 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/5: B 10 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 3/5: B 15 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 4/5: C after wound - Substack (28-901).tif (page 1) → 1 embryo(s) detected
  File 5/5: Contraction - Substack (1-95).tif (page 48) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 5/5

Initializing geometry from reference frame...
  16-bit embryo detection: background=353.9, embryo_threshold=424.6
  ⚠ Warning: Cannot determine head/tail from morphology for embryo B. Using default assignment. Consider manual specification.

  → Standard head-tail length: 157.2px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(120.0, 160.0), tail=(-35.7, 138.3), axis_length=157.2px, centroid=(90.5, 162.3)
  Embryo B: head=(151.0, 210.0), tail=(299.0, 263.0), axis_length=157.2px, centroid=(261.3, 233.2)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 83 early spark(s): (1128.2, 176.6)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1872 [POKE FRAME - t=0]...
  → Detected 15 spark detection(s), 15 track state(s) in poke frame
Processing frame 101/1872...
Processing frame 201/1872...
Processing frame 301/1872...
Processing frame 401/1872...
Processing frame 501/1872...
Processing frame 601/1872...
Processing frame 701/1872...
Processing frame 801/1872...
Processing frame 901/1872...
Processing frame 1001/1872...
Processing frame 1101/1872...
Processing frame 1201/1872...
Processing frame 1301/1872...
Processing frame 1401/1872...
Processing frame 1501/1872...
Processing frame 1601/1872...
Processing frame 1701/1872...
Processing frame 1801/1872...
Processing frame 1872/1872...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 5
  • Total frames processed: 1872
  • Spark detections:
    - Total raw detections: 10023
    - Total track states (CSV rows): 10023
    - Frames with detections: 1872/1872
    - Average detections per frame: 5.35
    - Max detections in single frame: 55
  • Unique tracks: 2153
  • Embryos detected: 2 (A, B)
  • Files with embryos: 5/5
  • Poke location: ✓ detected at (1128.2, 176.6)

Output files:
  • CSV: temp_24.csv
============================================================

  ✓ Completed folder 24
Processing folder 25...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/25
============================================================

Found 3 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1735

Searching for reference frame with embryos...
Checking first frame of 3 file(s) for embryos...

Frame dimensions: 2205x756 pixels

  File 1/3: B 5 min after wound - Substack (1-301).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/3

Initializing geometry from reference frame...
  16-bit embryo detection: background=427.4, embryo_threshold=512.9
  ⚠ Warning: Cannot determine head/tail from morphology for embryo B. Using default assignment. Consider manual specification.

  → Standard head-tail length: 930.5px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1092.0, 298.0), tail=(170.8, 428.9), axis_length=930.5px, centroid=(737.3, 403.7)
  Embryo B: head=(1107.0, 387.0), tail=(2037.2, 407.3), axis_length=930.5px, centroid=(1553.3, 344.2)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✗ No sparks found in first 20 post-poke frames

⚠ WARNING: Poke location not detected. dist_from_poke_px will be empty.
  → Consider providing --poke-x/--poke-y if auto-detection fails.

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1735 [POKE FRAME - t=0]...
  → Detected 0 spark detection(s), 0 track state(s) in poke frame
Processing frame 101/1735...
Processing frame 201/1735...
Processing frame 301/1735...
Processing frame 401/1735...
Processing frame 501/1735...
Processing frame 601/1735...
Processing frame 701/1735...
Processing frame 801/1735...
Processing frame 901/1735...
Processing frame 1001/1735...
Processing frame 1101/1735...
Processing frame 1201/1735...
Processing frame 1301/1735...
Processing frame 1401/1735...
Processing frame 1501/1735...
Processing frame 1601/1735...
Processing frame 1701/1735...
Processing frame 1735/1735...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 3
  • Total frames processed: 1735
  • Spark detections:
    - Total raw detections: 4028
    - Total track states (CSV rows): 4028
    - Frames with detections: 1628/1735
    - Average detections per frame: 2.32
    - Max detections in single frame: 16
  • Unique tracks: 828
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/3
  • Poke location: ✗ not found

Output files:
  • CSV: temp_25.csv
============================================================

  ✓ Completed folder 25
Processing folder 26...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/26
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 692

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2871x618 pixels

  File 1/2: B2 - Substack (1-361).tif (page 1) → 1 embryo(s) detected
  File 2/2: C2 - Substack (31-361).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 2/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=379.4, embryo_threshold=455.2

  → Using single embryo head-tail length: 2498.3px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(2610.0, 174.0), tail=(113.3, 263.6), axis_length=2498.3px, centroid=(1405.4, 315.1)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 40 early spark(s): (1549.6, 267.0)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/692 [POKE FRAME - t=0]...
  → Detected 7 spark detection(s), 7 track state(s) in poke frame
Processing frame 101/692...
Processing frame 201/692...
Processing frame 301/692...
Processing frame 401/692...
Processing frame 501/692...
Processing frame 601/692...
Processing frame 692/692...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 692
  • Spark detections:
    - Total raw detections: 3159
    - Total track states (CSV rows): 3159
    - Frames with detections: 692/692
    - Average detections per frame: 4.57
    - Max detections in single frame: 12
  • Unique tracks: 639
  • Embryos detected: 1 (A)
  • Files with embryos: 2/2
  • Poke location: ✓ detected at (1549.6, 267.0)

Output files:
  • CSV: temp_26.csv
============================================================

  ✓ Completed folder 26
Processing folder 27...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/27
============================================================

Found 3 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 903

Searching for reference frame with embryos...
Checking first frame of 3 file(s) for embryos...

Frame dimensions: 2934x756 pixels

  File 1/3: B 5 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/3: B 10 min after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 3/3: C pressure - Substack (1-301).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 3/3

Initializing geometry from reference frame...
  16-bit embryo detection: background=328.8, embryo_threshold=394.6

  → Using single embryo head-tail length: 2599.4px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(2712.0, 385.0), tail=(112.7, 364.3), axis_length=2599.4px, centroid=(1443.3, 369.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 6 early spark(s): (1656.5, 399.0)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/903 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/903...
Processing frame 201/903...
Processing frame 301/903...
Processing frame 401/903...
Processing frame 501/903...
Processing frame 601/903...
Processing frame 701/903...
Processing frame 801/903...
Processing frame 901/903...
Processing frame 903/903...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 3
  • Total frames processed: 903
  • Spark detections:
    - Total raw detections: 5443
    - Total track states (CSV rows): 5443
    - Frames with detections: 903/903
    - Average detections per frame: 6.03
    - Max detections in single frame: 20
  • Unique tracks: 835
  • Embryos detected: 1 (A)
  • Files with embryos: 3/3
  • Poke location: ✓ detected at (1656.5, 399.0)

Output files:
  • CSV: temp_27.csv
============================================================

  ✓ Completed folder 27
Processing folder 28...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/28
============================================================

Found 3 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 1415

Searching for reference frame with embryos...
Checking first frame of 3 file(s) for embryos...

Frame dimensions: 2952x752 pixels

  File 1/3: B 5 minutes after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 2/3: B 10 minutes after wound - Substack (1-301).tif (page 1) → 1 embryo(s) detected
  File 3/3: C - Substack (36-848).tif (page 1) → 1 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 3/3

Initializing geometry from reference frame...
  16-bit embryo detection: background=385.2, embryo_threshold=462.3

  → Using single embryo head-tail length: 2447.2px

=== EMBRYO DETECTION SUMMARY ===
✓ Found 1 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(2700.0, 365.0), tail=(253.0, 339.0), axis_length=2447.2px, centroid=(1507.1, 365.5)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 12 early spark(s): (1232.0, 500.6)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/1415 [POKE FRAME - t=0]...
  → Detected 2 spark detection(s), 2 track state(s) in poke frame
Processing frame 101/1415...
Processing frame 201/1415...
Processing frame 301/1415...
Processing frame 401/1415...
Processing frame 501/1415...
Processing frame 601/1415...
Processing frame 701/1415...
Processing frame 801/1415...
Processing frame 901/1415...
Processing frame 1001/1415...
Processing frame 1101/1415...
Processing frame 1201/1415...
Processing frame 1301/1415...
Processing frame 1401/1415...
Processing frame 1415/1415...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 3
  • Total frames processed: 1415
  • Spark detections:
    - Total raw detections: 3265
    - Total track states (CSV rows): 3265
    - Frames with detections: 1415/1415
    - Average detections per frame: 2.31
    - Max detections in single frame: 11
  • Unique tracks: 199
  • Embryos detected: 1 (A)
  • Files with embryos: 3/3
  • Poke location: ✓ detected at (1232.0, 500.6)

Output files:
  • CSV: temp_28.csv
============================================================

  ✓ Completed folder 28
Processing folder 29...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/29
============================================================

Found 1 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 360

Searching for reference frame with embryos...
Checking first frame of 1 file(s) for embryos...

Frame dimensions: 2920x880 pixels

  File 1/1: C - Substack (62-421).tif (page 1) → 3 embryo(s) detected

⚠ WARNING: No file with exactly 2 embryos found
  Using best available detection (0 embryo(s))

  Files with embryos detected: 1/1

Initializing geometry from reference frame...
  16-bit embryo detection: background=315.9, embryo_threshold=379.1

  → Standard head-tail length: 753.2px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(548.0, 580.0), tail=(-202.7, 518.4), axis_length=753.2px, centroid=(429.7, 587.6)
  Embryo B: head=(1462.0, 334.0), tail=(712.4, 407.8), axis_length=753.2px, centroid=(892.8, 438.0)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 41 early spark(s): (2295.8, 304.0)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/360 [POKE FRAME - t=0]...
  → Detected 5 spark detection(s), 5 track state(s) in poke frame
Processing frame 101/360...
Processing frame 201/360...
Processing frame 301/360...
Processing frame 360/360...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 1
  • Total frames processed: 360
  • Spark detections:
    - Total raw detections: 14337
    - Total track states (CSV rows): 14337
    - Frames with detections: 360/360
    - Average detections per frame: 39.83
    - Max detections in single frame: 129
  • Unique tracks: 3505
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/1
  • Poke location: ✓ detected at (2295.8, 304.0)

Output files:
  • CSV: temp_29.csv
============================================================

  ✓ Completed folder 29
Processing folder 30...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/30
============================================================

Found 1 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 340

Searching for reference frame with embryos...
Checking first frame of 1 file(s) for embryos...

Frame dimensions: 2960x996 pixels

  File 1/1: C2 - Substack (15-354).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/1

Initializing geometry from reference frame...
  16-bit embryo detection: background=321.4, embryo_threshold=385.7

  → Standard head-tail length: 1258.1px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1485.0, 526.0), tail=(226.9, 528.0), axis_length=1258.1px, centroid=(936.8, 481.8)
  Embryo B: head=(2959.0, 581.0), tail=(1700.9, 578.8), axis_length=1258.1px, centroid=(2363.3, 442.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 38 early spark(s): (2765.9, 396.4)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/340 [POKE FRAME - t=0]...
  → Detected 7 spark detection(s), 7 track state(s) in poke frame
Processing frame 101/340...
Processing frame 201/340...
Processing frame 301/340...
Processing frame 340/340...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 1
  • Total frames processed: 340
  • Spark detections:
    - Total raw detections: 4734
    - Total track states (CSV rows): 4734
    - Frames with detections: 340/340
    - Average detections per frame: 13.92
    - Max detections in single frame: 70
  • Unique tracks: 1121
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/1
  • Poke location: ✓ detected at (2765.9, 396.4)

Output files:
  • CSV: temp_30.csv
============================================================

  ✓ Completed folder 30
Processing folder 31...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/31
============================================================

Found 1 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 453

Searching for reference frame with embryos...
Checking first frame of 1 file(s) for embryos...

Frame dimensions: 2944x936 pixels

  File 1/1: C3 - Substack (48-500).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/1

Initializing geometry from reference frame...
  16-bit embryo detection: background=317.1, embryo_threshold=380.6
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.
  ⚠ Warning: Cannot determine head/tail from morphology for embryo B. Using default assignment. Consider manual specification.

  → Standard head-tail length: 1368.8px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(89.0, 568.0), tail=(1456.7, 514.7), axis_length=1368.8px, centroid=(735.3, 466.9)
  Embryo B: head=(1420.0, 373.0), tail=(2786.2, 289.0), axis_length=1368.8px, centroid=(2127.3, 421.3)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 6 early spark(s): (1804.7, 418.5)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/453 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/453...
Processing frame 201/453...
Processing frame 301/453...
Processing frame 401/453...
Processing frame 453/453...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 1
  • Total frames processed: 453
  • Spark detections:
    - Total raw detections: 5378
    - Total track states (CSV rows): 5378
    - Frames with detections: 453/453
    - Average detections per frame: 11.87
    - Max detections in single frame: 49
  • Unique tracks: 841
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/1
  • Poke location: ✓ detected at (1804.7, 418.5)

Output files:
  • CSV: temp_31.csv
============================================================

  ✓ Completed folder 31
Processing folder 32...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/32
============================================================

Found 2 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 829

Searching for reference frame with embryos...
Checking first frame of 2 file(s) for embryos...

Frame dimensions: 2960x928 pixels

  File 1/2: C4 001 - Substack (31-450).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/2

Initializing geometry from reference frame...
  16-bit embryo detection: background=326.6, embryo_threshold=391.9

  → Standard head-tail length: 1297.5px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(1547.0, 502.0), tail=(249.8, 473.0), axis_length=1297.5px, centroid=(896.7, 525.0)
  Embryo B: head=(1575.0, 428.0), tail=(2870.1, 349.2), axis_length=1297.5px, centroid=(2180.8, 456.2)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 6 early spark(s): (1326.6, 565.6)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/829 [POKE FRAME - t=0]...
  → Detected 1 spark detection(s), 1 track state(s) in poke frame
Processing frame 101/829...
Processing frame 201/829...
Processing frame 301/829...
Processing frame 401/829...
Processing frame 501/829...
Processing frame 601/829...
Processing frame 701/829...
Processing frame 801/829...
Processing frame 829/829...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 2
  • Total frames processed: 829
  • Spark detections:
    - Total raw detections: 3201
    - Total track states (CSV rows): 3201
    - Frames with detections: 825/829
    - Average detections per frame: 3.86
    - Max detections in single frame: 12
  • Unique tracks: 452
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/2
  • Poke location: ✓ detected at (1326.6, 565.6)

Output files:
  • CSV: temp_32.csv
============================================================

  ✓ Completed folder 32
Processing folder 33...

============================================================
Processing TIFF sequence from: /Users/jdietz/Documents/Levin/Embryos/33
============================================================

Found 1 TIFF file(s) (including subdirectories)
Frame rate: 1.0 fps
Poke frame index: 0 (t = 0)

Building frame index mapping...
Total frames available: 371

Searching for reference frame with embryos...
Checking first frame of 1 file(s) for embryos...

Frame dimensions: 2960x848 pixels

  File 1/1: C5 - Substack (51-421).tif (page 1) → 2 embryo(s) detected
    ✓ Using this file as reference (found 2 embryos)

  Files with embryos detected: 1/1

Initializing geometry from reference frame...
  16-bit embryo detection: background=325.9, embryo_threshold=391.0
  ⚠ Warning: Cannot determine head/tail from morphology for embryo A. Using default assignment. Consider manual specification.

  → Standard head-tail length: 1301.1px (from 2 embryo(s))

=== EMBRYO DETECTION SUMMARY ===
✓ Found 2 embryo(s) with directional axes

Embryo geometry:
  Embryo A: head=(153.0, 453.0), tail=(1453.8, 422.7), axis_length=1301.1px, centroid=(781.6, 420.2)
  Embryo B: head=(1455.0, 398.0), tail=(2755.7, 365.5), axis_length=1301.1px, centroid=(2108.7, 393.4)

=== POKE DETECTION SUMMARY ===
✗ WARNING: Could not auto-detect pink arrow
  → dist_from_poke_px will be empty unless you provide --poke-x/--poke-y
===================================


⚠ Poke location not detected via pink arrow.
  → Attempting to infer poke location from first spark clusters...
    (Processing early post-poke frames to find initial spark centroids)
  ✓ Inferred poke location from 22 early spark(s): (1697.6, 493.9)

Processing frames and tracking sparks...
(Processing frames incrementally to conserve memory...)

Processing frame 1/371 [POKE FRAME - t=0]...
  → Detected 3 spark detection(s), 3 track state(s) in poke frame
Processing frame 101/371...
Processing frame 201/371...
Processing frame 301/371...
Processing frame 371/371...

============================================================
PROCESSING COMPLETE
============================================================

Summary:
  • TIFF files processed: 1
  • Total frames processed: 371
  • Spark detections:
    - Total raw detections: 3383
    - Total track states (CSV rows): 3383
    - Frames with detections: 371/371
    - Average detections per frame: 9.12
    - Max detections in single frame: 29
  • Unique tracks: 917
  • Embryos detected: 2 (A, B)
  • Files with embryos: 1/1
  • Poke location: ✓ detected at (1697.6, 493.9)

Output files:
  • CSV: temp_33.csv
============================================================

  ✓ Completed folder 33

✓ Batch processing complete!
Output saved to: spark_tracks_with_regions.csv

Next steps:
  1. Backup old CSV: mv spark_tracks.csv spark_tracks_backup.csv
  2. Use new CSV: mv spark_tracks_with_regions.csv spark_tracks.csv
  3. Regenerate detection summary: python3 wave-vector-analysis/generate_detection_summary.py spark_tracks.csv
